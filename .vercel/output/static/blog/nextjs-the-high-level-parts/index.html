<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><script type="module" src="/_astro/BlogPost.astro_astro_type_script_index_0_lang.VZXdc8kb.js"></script><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.16.5"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://drew.is-a.dev/blog/nextjs-the-high-level-parts/"><!-- Primary Meta Tags --><title>NextJS: A High level overview</title><meta name="title" content="NextJS: A High level overview"><meta name="description" content="The main parts of Next JS"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://zessu.github.io/"><meta property="og:title" content="NextJS: A High level overview"><meta property="og:description" content="The main parts of Next JS"><meta property="og:image" content="https://drew.is-a.dev/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://x.com/amackzie"><meta property="twitter:title" content="NextJS: A High level overview"><meta property="twitter:description" content="The main parts of Next JS"><meta property="twitter:image" content="https://drew.is-a.dev/blog-placeholder-1.jpg"><script defer data-domain="drew.is-a.dev" src="https://plausible.io/js/script.js"></script><link rel="stylesheet" href="/_astro/_slug_.DfqFlesk.css">
<style>.Btn[data-astro-cid-bvzihdzo]{height:25px;display:flex;align-items:center;justify-content:space-between;border:none;border-radius:5px;overflow:hidden;box-shadow:5px 5px 10px #00000017;cursor:pointer;background-color:transparent;padding:0}.leftContainer[data-astro-cid-bvzihdzo]{height:100%;background-color:#e00;display:flex;align-items:center;justify-content:center;padding:10px;gap:8px}.leftContainer[data-astro-cid-bvzihdzo] .like[data-astro-cid-bvzihdzo]{color:#fff;font-weight:600}.count[data-astro-cid-bvzihdzo]{height:100%;display:flex;align-items:center;justify-content:center;font-weight:600;position:relative;background-color:#fff;padding:5px;color:#e00}.Btn[data-astro-cid-bvzihdzo]:hover .leftContainer[data-astro-cid-bvzihdzo]{background-color:#db0000}.Btn[data-astro-cid-bvzihdzo]:active .leftContainer[data-astro-cid-bvzihdzo]{background-color:#c90000}.Btn[data-astro-cid-bvzihdzo]:active .leftContainer[data-astro-cid-bvzihdzo] svg[data-astro-cid-bvzihdzo]{transform:scale(1.15);transform-origin:top}div[data-astro-cid-bvzihdzo]#like-container{display:flex;align-items:center;justify-content:center}main[data-astro-cid-bvzihdzo]{width:calc(100% - 2em);max-width:100%;margin:0}.hero-image[data-astro-cid-bvzihdzo]{width:100%}.hero-image[data-astro-cid-bvzihdzo] img[data-astro-cid-bvzihdzo]{display:block;border-radius:12px;box-shadow:var(--box-shadow)}.prose[data-astro-cid-bvzihdzo]{width:720px;max-width:calc(100% - 2em);margin:auto;padding:1em;color:rgb(var(--gray-dark))}.title[data-astro-cid-bvzihdzo]{margin-bottom:1em;padding:1em 0;text-align:center;line-height:1}.title[data-astro-cid-bvzihdzo] h1[data-astro-cid-bvzihdzo]{margin:0 0 .5em}.date[data-astro-cid-bvzihdzo]{margin-bottom:.5em;color:rgb(var(--gray))}.last-updated-on[data-astro-cid-bvzihdzo]{font-style:italic}#sf-reading-progress-bar[data-astro-cid-bvzihdzo]{position:fixed;top:0;left:0;z-index:9999;width:0%;height:5px;background-color:#46a787;margin:0}
</style><script type="module" src="/_astro/page.Cungvx1b.js"></script></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <div data-astro-cid-3ef6ksr2> <span id="name" style="color:#1e3a8a" class="cursor-pointer" data-astro-cid-3ef6ksr2>Andrew Makenzi</span> </div> <div class="internal-links" data-astro-cid-3ef6ksr2> <div data-astro-cid-3ef6ksr2> <a style="color: #1e3a8a" href="/" data-astro-cid-3ef6ksr2="true" class="mb-[0] p-0" data-astro-cid-eimmu3lg> <svg viewBox="0 0 24 24" fill="none" height="35px" width="35px" xmlns="http://www.w3.org/2000/svg" data-astro-cid-3ef6ksr2><g id="SVGRepo_bgCarrier" stroke-width="0" data-astro-cid-3ef6ksr2></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-3ef6ksr2></g><g id="SVGRepo_iconCarrier" data-astro-cid-3ef6ksr2> <path d="M22 22L2 22" stroke="#1C274C" stroke-width="1.5" stroke-linecap="round" data-astro-cid-3ef6ksr2></path> <path d="M2 11L6.06296 7.74968M22 11L13.8741 4.49931C12.7784 3.62279 11.2216 3.62279 10.1259 4.49931L9.34398 5.12486" stroke="#1C274C" stroke-width="1.5" stroke-linecap="round" data-astro-cid-3ef6ksr2></path> <path d="M15.5 5.5V3.5C15.5 3.22386 15.7239 3 16 3H18.5C18.7761 3 19 3.22386 19 3.5V8.5" stroke="#1C274C" stroke-width="1.5" stroke-linecap="round" data-astro-cid-3ef6ksr2></path> <path d="M4 22V9.5" stroke="#1C274C" stroke-width="1.5" stroke-linecap="round" data-astro-cid-3ef6ksr2></path> <path d="M20 9.5V13.5M20 22V17.5" stroke="#1C274C" stroke-width="1.5" stroke-linecap="round" data-astro-cid-3ef6ksr2></path> <path d="M15 22V17C15 15.5858 15 14.8787 14.5607 14.4393C14.1213 14 13.4142 14 12 14C10.5858 14 9.87868 14 9.43934 14.4393M9 22V17" stroke="#1C274C" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-3ef6ksr2></path> <path d="M14 9.5C14 10.6046 13.1046 11.5 12 11.5C10.8954 11.5 10 10.6046 10 9.5C10 8.39543 10.8954 7.5 12 7.5C13.1046 7.5 14 8.39543 14 9.5Z" stroke="#1C274C" stroke-width="1.5" data-astro-cid-3ef6ksr2></path> </g></svg> </a>  <a style="color: #1e3a8a" href="/blog" data-astro-cid-3ef6ksr2="true" class="mb-[0] p-0" data-astro-cid-eimmu3lg>  </a>  </div> </div> <div data-astro-cid-3ef6ksr2></div> </nav> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2025-12-11T21:00:00.000Z"> Dec 12, 2025 </time>  </div> <h2 data-astro-cid-bvzihdzo>NextJS: A High level overview</h2> <div id="like-container" data-astro-cid-bvzihdzo> <button class="Btn" data-astro-cid-bvzihdzo> <span class="leftContainer" id="increaseCount" data-astro-cid-bvzihdzo> <svg fill="white" viewBox="0 0 512 512" height="1em" xmlns="http://www.w3.org/2000/svg" data-astro-cid-bvzihdzo><path d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z" data-astro-cid-bvzihdzo></path></svg> <span class="like" data-astro-cid-bvzihdzo>Like</span> </span> <span class="count" id="like-count" data-astro-cid-bvzihdzo> 0 likes </span> <span class="count" id="read-count" data-astro-cid-bvzihdzo> 0 reads </span> </button> </div> </div> <hr data-astro-cid-bvzihdzo> <div id="sf-reading-progress-bar" data-astro-cid-bvzihdzo></div>  <br>
<h4 id="why-next-js"><code>Why NEXT JS</code></h4>
<p><strong>Nextjs</strong> was originally built to solve one main problem with client rendered components. <strong>SEO</strong>. With client side framworks like react, code is rendered on the client. This involves fetching a bundle of JS and hydrating everything on the client. There is really no way for search engines to index our sites.</p>
<p>Indexing is important because it enables your page to show up on Google search. If you are selling Mahogany tables on your site, you want to have organic traffic to your site when someone searches for mahogany tables on google. As such you want google and other search engines to be able to parse and index the different pages with products on your site and for them to do this, the content has to be rendered on the server.</p>
<h4 id="server-vs-client-components"><code>Server vs Client Components</code></h4>
<p>Server components are components rendered on the server and client components are components rendered on the client. Why a differentiation? Well because some components still need client side interactivity. We usually render pages on the server that do not need any complex interactivity. Think header and footers. They mostly contain links to other pages. These are prime targets for server rendered content</p>
<p>A prime example of a good client component is an interactive search component that needs state or a chart that needs complex interactions. By default, components in next js are rendered on the server unless you mark them with the ‚Äúuse client‚Äù directive. Example below</p>
<pre class="astro-code astro-code-themes synthwave-84 dracula" style="background-color:#262335;--shiki-dark-bg:#282A36;color:#bbbbbb;--shiki-dark:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// app/page.js -> default page</span></span>
<span class="line"><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// By default, this is a Server Component.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#72F1B8;--shiki-dark:#FF79C6">import</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> { </span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">CommentForm</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> } </span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">from</span><span style="color:#FF8B39;--shiki-dark:#E9F284"> '</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">./comment-form</span><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">; </span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// Imports the Client Component</span></span>
<span class="line"><span style="color:#72F1B8;--shiki-dark:#FF79C6">import</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> { </span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">fetchStaticContent</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> } </span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">from</span><span style="color:#FF8B39;--shiki-dark:#E9F284"> '</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">./database</span><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">; </span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// A hypothetical BE data function</span></span>
<span class="line"></span>
<span class="line"><span style="color:#72F1B8;--shiki-dark:#FF79C6">export</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> default</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> async</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> function</span><span style="color:#36F9F6;--shiki-dark:#50FA7B"> Page</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#FEDE5D;--shiki-dark:#FF79C6">  const</span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2"> staticText</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6"> =</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> await</span><span style="color:#36F9F6;--shiki-dark:#50FA7B"> fetchStaticContent</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">(); </span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// Runs ON THE SERVER</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FEDE5D;--shiki-dark:#FF79C6">  return</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> (</span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">    &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">div</span><span style="color:#FEDE5D;--shiki-light-font-style:inherit;--shiki-dark:#50FA7B;--shiki-dark-font-style:italic"> className</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6">=</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">container</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">      &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">h1</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">Static Post Title</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">&#x3C;/</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">h1</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">      &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">p</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">{</span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">staticText</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">}</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">&#x3C;/</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">p</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> {</span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">/* Static text rendered by the server */</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">}</span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">      &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">hr</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2"> /></span></span>
<span class="line"><span style="color:#FEDE5D;--shiki-dark:#FF79C6">      {</span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">/* ‚ö†Ô∏è This is where the Client Component is placed (a boundary) */</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">}</span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">      &#x3C;</span><span style="color:#FE4450;--shiki-light-font-style:inherit;--shiki-dark:#8BE9FD;--shiki-dark-font-style:italic">CommentForm</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2"> /></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">    &#x3C;/</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">div</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">  );</span></span>
<span class="line"><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre>
<br>
The Comment form in this case is a client rendered component because it relies on client state. We denote is as a client component using the "use client.
<br>
<pre class="astro-code astro-code-themes synthwave-84 dracula" style="background-color:#262335;--shiki-dark-bg:#282A36;color:#bbbbbb;--shiki-dark:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// app/comment-form.js</span></span>
<span class="line"><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">use client</span><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">; </span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// ‚ö†Ô∏è This runs ONLY on the browser</span></span>
<span class="line"></span>
<span class="line"><span style="color:#72F1B8;--shiki-dark:#FF79C6">export</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> function</span><span style="color:#36F9F6;--shiki-dark:#50FA7B"> CommentForm</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#FEDE5D;--shiki-dark:#FF79C6">  const</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> [</span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">isSubmitting</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">, </span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">setIsSubmitting</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">] </span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6">=</span><span style="color:#36F9F6;--shiki-dark:#50FA7B"> useState</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">(</span><span style="color:#F97E72;--shiki-dark:#BD93F9">false</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">); </span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// can only happen on the client</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FEDE5D;--shiki-dark:#FF79C6">  return</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> (</span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">    &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">form</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">      &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">textarea</span><span style="color:#FEDE5D;--shiki-light-font-style:inherit;--shiki-dark:#50FA7B;--shiki-dark-font-style:italic"> name</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6">=</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">comment</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#FEDE5D;--shiki-light-font-style:inherit;--shiki-dark:#50FA7B;--shiki-dark-font-style:italic"> required</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2"> /></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">      &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">button</span><span style="color:#FEDE5D;--shiki-light-font-style:inherit;--shiki-dark:#50FA7B;--shiki-dark-font-style:italic"> type</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6">=</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">submit</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#FEDE5D;--shiki-light-font-style:inherit;--shiki-dark:#50FA7B;--shiki-dark-font-style:italic"> disabled</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6">=</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">{</span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">isSubmitting</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">}</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#FEDE5D;--shiki-dark:#FF79C6">        {</span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">isSubmitting</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> ?</span><span style="color:#FF8B39;--shiki-dark:#E9F284"> '</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">Posting...</span><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> :</span><span style="color:#FF8B39;--shiki-dark:#E9F284"> '</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">Post Comment</span><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">}</span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">      &#x3C;/</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">button</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">    &#x3C;/</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">form</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">  );</span></span>
<span class="line"><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">}</span></span></code></pre>
<br>
<h4 id="the-how"><code>The how</code></h4>
<p>So now that we have seen client and server components, it is clear why we might need both. Server components help with <strong>SEO</strong> and also help render content on the server that we can immediately view. We get static HTML fast. Client components use react and run on the client so we get all the benefits of react that we do not get with server rendered templating engines like <em>Razor Pages, PHP, HandleBar JS</em>. ie complex client-side state management, component re-usability and modelling, virtual DOM diffing, good DX, hot reloading in dev e.t.c</p>
<p>Traditionally, with react/angular and other client rendered frameworks, the browser fetches a bundle of JS when the client visits your domain which is then used to hydrate the DOM to see the components and pages. With server rendered pages, all pages are rendered directly on the server and their HTML returned except components marked with ‚Äúuse client‚Äù.</p>
<p>Components marked with <strong>‚Äúuse client‚Äù</strong> are expected to be rendered on the client, so next sends markers denoting what payloads the client needs to ask from the server. This might look like this.</p>
<pre class="astro-code astro-code-themes synthwave-84 dracula" style="background-color:#262335;--shiki-dark-bg:#282A36;color:#bbbbbb;--shiki-dark:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">&#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">div</span><span style="color:#FEDE5D;--shiki-light-font-style:inherit;--shiki-dark:#50FA7B;--shiki-dark-font-style:italic"> class</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6">=</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">container</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">  &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">h1</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">Static Post Title</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">&#x3C;/</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">h1</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">  &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">p</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">Welcome to our blog!</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">&#x3C;/</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">p</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">  &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">hr</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2"> /></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">  &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">div</span><span style="color:#FEDE5D;--shiki-light-font-style:inherit;--shiki-dark:#50FA7B;--shiki-dark-font-style:italic"> data-rsc-id</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6">=</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">123</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">>&#x3C;/</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">div</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">&#x3C;/</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">div</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span></code></pre>
<br>
The original component on the server before SSR üëá‚¨á‚¨á
<br>
<pre class="astro-code astro-code-themes synthwave-84 dracula" style="background-color:#262335;--shiki-dark-bg:#282A36;color:#bbbbbb;--shiki-dark:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// app/page.js</span></span>
<span class="line"><span style="color:#72F1B8;--shiki-dark:#FF79C6">import</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> { </span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">CommentForm</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> } </span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">from</span><span style="color:#FF8B39;--shiki-dark:#E9F284"> '</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">./comment-form</span><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">; </span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// Imports the Client Component</span></span>
<span class="line"><span style="color:#72F1B8;--shiki-dark:#FF79C6">import</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> { </span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">fetchStaticContent</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> } </span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">from</span><span style="color:#FF8B39;--shiki-dark:#E9F284"> '</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">./database</span><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">; </span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// A hypothetical BE data function</span></span>
<span class="line"></span>
<span class="line"><span style="color:#72F1B8;--shiki-dark:#FF79C6">export</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> default</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> async</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> function</span><span style="color:#36F9F6;--shiki-dark:#50FA7B"> Page</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#FEDE5D;--shiki-dark:#FF79C6">  const</span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2"> staticText</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6"> =</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> await</span><span style="color:#36F9F6;--shiki-dark:#50FA7B"> fetchStaticContent</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">(); </span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// Runs ON THE SERVER</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FEDE5D;--shiki-dark:#FF79C6">  return</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> (</span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">    &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">div</span><span style="color:#FEDE5D;--shiki-light-font-style:inherit;--shiki-dark:#50FA7B;--shiki-dark-font-style:italic"> className</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6">=</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">container</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">      &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">h1</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">Static Post Title</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">&#x3C;/</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">h1</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">      &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">p</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">{</span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">staticText</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">}</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">&#x3C;/</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">p</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> {</span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">/* Static text rendered by the server */</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">}</span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">      &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">hr</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2"> /></span></span>
<span class="line"><span style="color:#FEDE5D;--shiki-dark:#FF79C6">      {</span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">/* ‚ö†Ô∏è This component is sent as RSC payload */</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">}</span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">      &#x3C;</span><span style="color:#FE4450;--shiki-light-font-style:inherit;--shiki-dark:#8BE9FD;--shiki-dark-font-style:italic">CommentForm</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2"> /></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">    &#x3C;/</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">div</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">  );</span></span>
<span class="line"><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">}</span></span></code></pre>
<br>
On the client, nextjs has a runtime, the client runtime, that parses the content displaying it until it encounters
<pre class="astro-code astro-code-themes synthwave-84 dracula" style="background-color:#262335;--shiki-dark-bg:#282A36;color:#bbbbbb;--shiki-dark:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>&#x3C;div data-rsc-id="123">&#x3C;/div></span></span></code></pre>
<p>Here, it knows it needs to load some code from the server. The id is the identifier of the prepared payload which next constructs when it renders the server component. This looks like this ‚¨á‚¨áüëá</p>
<pre class="astro-code astro-code-themes synthwave-84 dracula" style="background-color:#262335;--shiki-dark-bg:#282A36;color:#bbbbbb;--shiki-dark:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="json"><code><span class="line"><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">[</span></span>
<span class="line"><span style="color:#FF8B39;--shiki-dark:#E9F284">  "</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">$$</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">,              </span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// Type identifier for a component reference</span></span>
<span class="line"><span style="color:#FF8B39;--shiki-dark:#E9F284">  "</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">app/comment-form.js</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">, </span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// üëà This is the bundle path identifier</span></span>
<span class="line"><span style="color:#F97E72;--shiki-dark:#BD93F9">  null</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">,              </span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// Initial props (if any)</span></span>
<span class="line"><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">  {</span></span>
<span class="line"><span style="color:#72F1B8;--shiki-dark:#8BE9FE">    "</span><span style="color:#72F1B8;--shiki-dark:#8BE9FD">children</span><span style="color:#72F1B8;--shiki-dark:#8BE9FE">"</span><span style="color:#BBBBBB;--shiki-dark:#FF79C6">:</span><span style="color:#FF8B39;--shiki-dark:#E9F284"> "</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">...</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit"> // Any Server Component children that were passed</span></span>
<span class="line"><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">  }</span></span>
<span class="line"><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">]</span></span></code></pre>
<p>So in this case next knows to load the client code for the comment form, which it does using a fetch request. This is then rendered and hydrated using react. Now we understand how both server and client components are rendered.</p>
<h4 id="the-rsc-payload-suspense-serialization-and-cves"><code>The RSC payload, Suspense, Serialization and CVE's</code></h4>
<p>The <strong>RSC</strong> payload is a binary format that next uses to send data to the client in the case of client components but also from the client to the server with the <code>server actions</code> feature. All communication back and forth is done using RSC payloads with a protocol called the <strong>flight protocol</strong> that defines serialization formas and standards for communication from client to server.</p>
<p>We have already looked at how client components are loaded. This is also how the suspense feature works and server actions. Lets explore these briefly. When next js asks you to implement Suspense boundary like</p>
<pre class="astro-code astro-code-themes synthwave-84 dracula" style="background-color:#262335;--shiki-dark-bg:#282A36;color:#bbbbbb;--shiki-dark:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">&#x3C;</span><span style="color:#FE4450;--shiki-light-font-style:inherit;--shiki-dark:#8BE9FD;--shiki-dark-font-style:italic">Suspense</span><span style="color:#FEDE5D;--shiki-light-font-style:inherit;--shiki-dark:#50FA7B;--shiki-dark-font-style:italic"> fallback</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6">=</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">{</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">&#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">div</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">Loading...</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">&#x3C;/</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">div</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">}</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2"> &#x3C;</span><span style="color:#FE4450;--shiki-light-font-style:inherit;--shiki-dark:#8BE9FD;--shiki-dark-font-style:italic">CommentForm</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2"> /></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">&#x3C;/</span><span style="color:#FE4450;--shiki-light-font-style:inherit;--shiki-dark:#8BE9FD;--shiki-dark-font-style:italic">Suspense</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span></code></pre>
<p>or even using a <code>loading.js</code> file, it server-side renders the loading.js file or the loading div and displays it on the client showing immediate feedback to the user. It then sees the RSC payload with an id and requests for the CommentForm from the server, rendering it when fully downloaded. This is how suspense works.</p>
<p>The RSC payload is also used to send data to server actions. Server actions are functions stored in the server that we can call to do things. e.g update the number of likes when someone clicks a button or leave a comment on a post of form as shown below üëá</p>
<pre class="astro-code astro-code-themes synthwave-84 dracula" style="background-color:#262335;--shiki-dark-bg:#282A36;color:#bbbbbb;--shiki-dark:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">use server</span><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">; </span><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// üëà Server Action directive, use to mark server functions</span></span>
<span class="line"></span>
<span class="line"><span style="color:#72F1B8;--shiki-dark:#FF79C6">import</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> { </span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">db</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> } </span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">from</span><span style="color:#FF8B39;--shiki-dark:#E9F284"> '</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">@/lib/db</span><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#72F1B8;--shiki-dark:#FF79C6">export</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> async</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> function</span><span style="color:#36F9F6;--shiki-dark:#50FA7B"> createComment</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">(</span><span style="color:#FF7EDB;--shiki-light-font-style:italic;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic">formData</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FEDE5D;--shiki-dark:#FF79C6">  const</span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2"> title</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6"> =</span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2"> formData</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">.</span><span style="color:#36F9F6;--shiki-dark:#50FA7B">get</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">(</span><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">title</span><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">);</span></span>
<span class="line"><span style="color:#FEDE5D;--shiki-dark:#FF79C6">  const</span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2"> content</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6"> =</span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2"> formData</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">.</span><span style="color:#36F9F6;--shiki-dark:#50FA7B">get</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">(</span><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">content</span><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">);</span></span>
<span class="line"><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">  </span></span>
<span class="line"><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">  // ‚ö†Ô∏è Runs securely on the server</span></span>
<span class="line"><span style="color:#FEDE5D;--shiki-dark:#FF79C6">  await</span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2"> db</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">.</span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">comments</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">.</span><span style="color:#36F9F6;--shiki-dark:#50FA7B">create</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">({ </span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">data</span><span style="color:#B6B1B1;--shiki-dark:#FF79C6">:</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> { </span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">title</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">, </span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">content</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> } }); </span></span>
<span class="line"><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">// app/comment-form.js</span></span>
<span class="line"><span style="color:#72F1B8;--shiki-dark:#FF79C6">import</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> { </span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">createComment</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> } </span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">from</span><span style="color:#FF8B39;--shiki-dark:#E9F284"> '</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">@/actions/create-comment</span><span style="color:#FF8B39;--shiki-dark:#E9F284">'</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#72F1B8;--shiki-dark:#FF79C6">export</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> default</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6"> function</span><span style="color:#36F9F6;--shiki-dark:#50FA7B"> CommentForm</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#848BBD;--shiki-light-font-style:italic;--shiki-dark:#6272A4;--shiki-dark-font-style:inherit">  // Pass the Server Action directly to the form's action prop</span></span>
<span class="line"><span style="color:#FEDE5D;--shiki-dark:#FF79C6">  return</span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> (</span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">    &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">form</span><span style="color:#FEDE5D;--shiki-light-font-style:inherit;--shiki-dark:#50FA7B;--shiki-dark-font-style:italic"> action</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6">=</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">{</span><span style="color:#FF7EDB;--shiki-dark:#F8F8F2">createComment</span><span style="color:#FEDE5D;--shiki-dark:#FF79C6">}</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">      &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">input</span><span style="color:#FEDE5D;--shiki-light-font-style:inherit;--shiki-dark:#50FA7B;--shiki-dark-font-style:italic"> type</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6">=</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">text</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#FEDE5D;--shiki-light-font-style:inherit;--shiki-dark:#50FA7B;--shiki-dark-font-style:italic"> name</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6">=</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">title</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2"> /></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">      &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">textarea</span><span style="color:#FEDE5D;--shiki-light-font-style:inherit;--shiki-dark:#50FA7B;--shiki-dark-font-style:italic"> name</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6">=</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">content</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2"> /></span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">      &#x3C;</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">button</span><span style="color:#FEDE5D;--shiki-light-font-style:inherit;--shiki-dark:#50FA7B;--shiki-dark-font-style:italic"> type</span><span style="color:#FFFFFFEE;--shiki-dark:#FF79C6">=</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#FF8B39;--shiki-dark:#F1FA8C">submit</span><span style="color:#FF8B39;--shiki-dark:#E9F284">"</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">Submit</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">&#x3C;/</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">button</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span><span style="color:#BBBBBB;--shiki-dark:#F8F8F2"> // calls createComment from client on submission, passing data from client to server</span></span>
<span class="line"><span style="color:#36F9F6;--shiki-dark:#F8F8F2">    &#x3C;/</span><span style="color:#72F1B8;--shiki-dark:#FF79C6">form</span><span style="color:#36F9F6;--shiki-dark:#F8F8F2">></span></span>
<span class="line"><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">  );</span></span>
<span class="line"><span style="color:#BBBBBB;--shiki-dark:#F8F8F2">}</span></span></code></pre>
<p>In this case our RSC payload has to tell nextjs what function to call on the server and what to call it with. ie call the <strong>createcomment</strong> function and call it with <em><strong>formData</strong></em>. This is all encoded by next an sent in the RSC payload, pointing to the exact function we need to call and arguments we need to pass. Next also sends request headers, cookies that might help identify the client. Again, the protocol that governs this communication between the client and the component i.e standards like the binary format, serialization and deserialization is called the flight protocol.</p>
<p>Anytime you take user input from the client and you want to use it on the server, you need to sanitize it well. A critical vulnerability recently exploited next js by giving it malicious input allowing remote code execution once next evaluated the user provided input. This is explained here <a href="https://nextjs.org/blog/CVE-66478">https://nextjs.org/blog/CVE-66478</a> . I also wrote a proof of concept I wrote here <a href="https://github.com/zessu/CVE-2025-55182-Typescript/blob/master/poc.ts">https://github.com/zessu/CVE-2025-55182-Typescript/blob/master/poc.ts</a></p>
<h3 id="conclusion">Conclusion</h3>
<p>So hopefully you now have a better understanding of how server components and client components work and a better understanding of next js, where client and server components are rendered, how they are rendered and how communication happens between the client and the server.</p>
<p>Often times I here people say next.js is just JS coming <em>full circle</em>, PHP style and I hope this article shows you the difference. Next can server side render content like PHP, .NET, <a href="https://handlebarsjs.com/">Handlebars.js</a> and Django but it also lets us use react for our client components. We get the best of both worlds, server rendered content where we need it and a full JS framework with virtual DOM, state, components, signals e.t.c while still giving us other next js features like server actions, caching, <a href="https://nextjs.org/docs/pages/building-your-application/routing">an amazing router</a>, Image optimization components, Font Optimizations and unified developer experience e.t.c</p>
<h4 id="references">References</h4>
<p><a href="https://nextjs.org">Next JS blog</a> <br>
<a href="https://github.com/msanft/CVE-2025-55182">CVE-2025-66478</a></p>  </div> </article> </main> <div id="data-container" data-likes="0" data-reads="0" data-hash="76bbf063494b9a2dfd5fd5be80621dd5f6aeddf05511586d6f893b022f7f52c4" data-astro-cid-bvzihdzo></div> <footer data-astro-cid-sz7xmlte>
&copy; 2025 Andrew Makenzi. All rights reserved.
<div class="social-links" data-astro-cid-sz7xmlte> <a href="https://twitter.com/amackzie" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Follow Me on Twitter</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/twitter" data-astro-cid-sz7xmlte><path fill="currentColor" d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://github.com/zessu" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Check out my github</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/github" data-astro-cid-sz7xmlte><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-sz7xmlte></path></svg> </a> </div> </footer>  <script type="module" src="/_astro/BlogPost.astro_astro_type_script_index_1_lang.BtOU-HKl.js"></script> </body> </html>