function g(t){const e=P(t),o=new ArrayBuffer(e.length),n=new DataView(o);for(let s=0;s<o.byteLength;s++)n.setUint8(s,e.charCodeAt(s));return o}const L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function P(t){t.length%4===0&&(t=t.replace(/==?$/,""));let e="",o=0,n=0;for(let s=0;s<t.length;s++)o<<=6,o|=L.indexOf(t[s]),n+=6,n===24&&(e+=String.fromCharCode((o&16711680)>>16),e+=String.fromCharCode((o&65280)>>8),e+=String.fromCharCode(o&255),o=n=0);return n===12?(o>>=4,e+=String.fromCharCode(o)):n===18&&(o>>=2,e+=String.fromCharCode((o&65280)>>8),e+=String.fromCharCode(o&255)),e}const k=-1,D=-2,B=-3,F=-4,M=-5,$=-6;function v(t,e){return j(JSON.parse(t),e)}function j(t,e){if(typeof t=="number")return s(t,!0);if(!Array.isArray(t)||t.length===0)throw new Error("Invalid input");const o=t,n=Array(o.length);function s(r,l=!1){if(r===k)return;if(r===B)return NaN;if(r===F)return 1/0;if(r===M)return-1/0;if(r===$)return-0;if(l)throw new Error("Invalid input");if(r in n)return n[r];const a=o[r];if(!a||typeof a!="object")n[r]=a;else if(Array.isArray(a))if(typeof a[0]=="string"){const i=a[0],u=e?.[i];if(u)return n[r]=u(s(a[1]));switch(i){case"Date":n[r]=new Date(a[1]);break;case"Set":const d=new Set;n[r]=d;for(let c=1;c<a.length;c+=1)d.add(s(a[c]));break;case"Map":const E=new Map;n[r]=E;for(let c=1;c<a.length;c+=2)E.set(s(a[c]),s(a[c+1]));break;case"RegExp":n[r]=new RegExp(a[1],a[2]);break;case"Object":n[r]=Object(a[1]);break;case"BigInt":n[r]=BigInt(a[1]);break;case"null":const h=Object.create(null);n[r]=h;for(let c=1;c<a.length;c+=2)h[a[c]]=s(a[c+1]);break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":{const c=globalThis[i],y=a[1],b=g(y),U=new c(b);n[r]=U;break}case"ArrayBuffer":{const c=a[1],y=g(c);n[r]=y;break}default:throw new Error(`Unknown type ${i}`)}}else{const i=new Array(a.length);n[r]=i;for(let u=0;u<a.length;u+=1){const d=a[u];d!==D&&(i[u]=s(d))}}else{const i={};n[r]=i;for(const u in a){const d=a[u];i[u]=s(d)}}return n[r]}return s(0)}function H(t){return t.endsWith("/")?t:t+"/"}const T={actionName:"_action",actionPayload:"_astroActionPayload"},V=T,Q=H,N={BAD_REQUEST:400,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,TIMEOUT:405,CONFLICT:409,PRECONDITION_FAILED:412,PAYLOAD_TOO_LARGE:413,UNSUPPORTED_MEDIA_TYPE:415,UNPROCESSABLE_CONTENT:422,TOO_MANY_REQUESTS:429,CLIENT_CLOSED_REQUEST:499,INTERNAL_SERVER_ERROR:500},Y=Object.entries(N).reduce((t,[e,o])=>({...t,[o]:e}),{});class f extends Error{type="AstroActionError";code="INTERNAL_SERVER_ERROR";status=500;constructor(e){super(e.message),this.code=e.code,this.status=f.codeToStatus(e.code),e.stack&&(this.stack=e.stack)}static codeToStatus(e){return N[e]}static statusToCode(e){return Y[e]??"INTERNAL_SERVER_ERROR"}static fromJson(e){return q(e)?new G(e.issues):J(e)?new f(e):new f({code:"INTERNAL_SERVER_ERROR"})}}function J(t){return typeof t=="object"&&t!=null&&"type"in t&&t.type==="AstroActionError"}function q(t){return typeof t=="object"&&t!=null&&"type"in t&&t.type==="AstroActionInputError"&&"issues"in t&&Array.isArray(t.issues)}class G extends f{type="AstroActionInputError";issues;fields;constructor(e){super({message:`Failed to validate: ${JSON.stringify(e,null,2)}`,code:"BAD_REQUEST"}),this.issues=e,this.fields={};for(const o of e)if(o.path.length>0){const n=o.path[0].toString();this.fields[n]??=[],this.fields[n]?.push(o.message)}}}function I(t){return`?${new URLSearchParams({[T.actionName]:t}).toString()}`}function A(t){if(t.type==="error"){let e;try{e=JSON.parse(t.body)}catch{return{data:void 0,error:new f({message:t.body,code:"INTERNAL_SERVER_ERROR"})}}return{error:f.fromJson(e),data:void 0}}return t.type==="empty"?{data:void 0,error:void 0}:{data:v(t.body,{URL:e=>new URL(e)}),error:void 0}}const z="%2E";function O(t={},e=""){return new Proxy(t,{get(o,n){if(n in o||typeof n=="symbol")return o[n];const s=e+encodeURIComponent(n.toString()).replaceAll(".",z);function r(l){return p(l,s)}return Object.assign(r,{queryString:I(s),toString:()=>r.queryString,$$FORM_ACTION:function(){return{method:"POST",name:"_astroAction",action:"?"+new URLSearchParams(r.toString()).toString()}},async orThrow(l){const{data:a,error:i}=await p(l,s);if(i)throw i;return a}}),O(r,s+".")}})}function Z(t){let e=`${"/".replace(/\/$/,"")}/_actions/${new URLSearchParams(t.toString()).get(V.actionName)}`;return e=Q(e),e}async function p(t,e,o){const n=new Headers;n.set("Accept","application/json");let s=t;if(!(s instanceof FormData)){try{s=JSON.stringify(t)}catch(l){throw new f({code:"BAD_REQUEST",message:`Failed to serialize request body to JSON. Full error: ${l.message}`})}s?n.set("Content-Type","application/json"):n.set("Content-Length","0")}const r=await fetch(Z({toString(){return I(e)}}),{method:"POST",body:s,headers:n});return r.status===204?A({type:"empty",status:204}):A({type:r.ok?"data":"error",body:await r.text()})}const w=O(),C=document.getElementById("data-container"),R=C?.dataset.likes,S=C?.dataset.hash,W=R?Number(R):0,_=S||"",X=document.querySelector("span#increaseCount"),m=document.getElementById("like-count");X?.addEventListener("click",async()=>{const{data:t,error:e}=await w.likePost({hash:_});t&&m&&(m.innerHTML=`${W+1} likes`)});setTimeout(async()=>{await w.updatePostVisits({hash:_})},1e3*20);document.addEventListener("DOMContentLoaded",()=>{console.log("DOM content loaded");const t=document.getElementById("sf-reading-progress-bar");if(t){let e=!1;window.addEventListener("scroll",()=>{const o=document.documentElement.scrollTop||document.body.scrollTop,n=document.querySelector("footer")?.clientHeight??0,s=document.documentElement.scrollHeight-(document.documentElement.clientHeight+n),r=o/s*100;t.style.width=`${r}%`,r>=96&&!e&&(e=!0,confetti({particleCount:100,spread:70,origin:{y:.5}}))})}});
