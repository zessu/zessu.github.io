import{i as C}from"./client.B9YBqyHK.js";function w(e){const t=L(e),a=new ArrayBuffer(t.length),n=new DataView(a);for(let s=0;s<a.byteLength;s++)n.setUint8(s,t.charCodeAt(s));return a}const U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function L(e){e.length%4===0&&(e=e.replace(/==?$/,""));let t="",a=0,n=0;for(let s=0;s<e.length;s++)a<<=6,a|=U.indexOf(e[s]),n+=6,n===24&&(t+=String.fromCharCode((a&16711680)>>16),t+=String.fromCharCode((a&65280)>>8),t+=String.fromCharCode(a&255),a=n=0);return n===12?(a>>=4,t+=String.fromCharCode(a)):n===18&&(a>>=2,t+=String.fromCharCode((a&65280)>>8),t+=String.fromCharCode(a&255)),t}const b=-1,P=-2,k=-3,F=-4,B=-5,M=-6;function H(e,t){return v(JSON.parse(e),t)}function v(e,t){if(typeof e=="number")return s(e,!0);if(!Array.isArray(e)||e.length===0)throw new Error("Invalid input");const a=e,n=Array(a.length);function s(r,l=!1){if(r===b)return;if(r===k)return NaN;if(r===F)return 1/0;if(r===B)return-1/0;if(r===M)return-0;if(l||typeof r!="number")throw new Error("Invalid input");if(r in n)return n[r];const o=a[r];if(!o||typeof o!="object")n[r]=o;else if(Array.isArray(o))if(typeof o[0]=="string"){const i=o[0],u=t&&Object.hasOwn(t,i)?t[i]:void 0;if(u){let E=o[1];return typeof E!="number"&&(E=a.push(o[1])-1),n[r]=u(s(E))}switch(i){case"Date":n[r]=new Date(o[1]);break;case"Set":const E=new Set;n[r]=E;for(let c=1;c<o.length;c+=1)E.add(s(o[c]));break;case"Map":const R=new Map;n[r]=R;for(let c=1;c<o.length;c+=2)R.set(s(o[c]),s(o[c+1]));break;case"RegExp":n[r]=new RegExp(o[1],o[2]);break;case"Object":n[r]=Object(o[1]);break;case"BigInt":n[r]=BigInt(o[1]);break;case"null":const y=Object.create(null);n[r]=y;for(let c=1;c<o.length;c+=2)y[o[c]]=s(o[c+1]);break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":{const c=globalThis[i],T=new c(s(o[1]));n[r]=o[2]!==void 0?T.subarray(o[2],o[3]):T;break}case"ArrayBuffer":{const c=o[1],T=w(c);n[r]=T;break}case"Temporal.Duration":case"Temporal.Instant":case"Temporal.PlainDate":case"Temporal.PlainTime":case"Temporal.PlainDateTime":case"Temporal.PlainMonthDay":case"Temporal.PlainYearMonth":case"Temporal.ZonedDateTime":{const c=i.slice(9);n[r]=Temporal[c].from(o[1]);break}case"URL":{const c=new URL(o[1]);n[r]=c;break}case"URLSearchParams":{const c=new URLSearchParams(o[1]);n[r]=c;break}default:throw new Error(`Unknown type ${i}`)}}else{const i=new Array(o.length);n[r]=i;for(let u=0;u<o.length;u+=1){const E=o[u];E!==P&&(i[u]=s(E))}}else{const i={};n[r]=i;for(const u in o){if(u==="__proto__")throw new Error("Cannot parse an object with a `__proto__` property");const E=o[u];i[u]=s(E)}}return n[r]}return s(0)}function Q(e){return e.endsWith("/")?e:e+"/"}const h={actionName:"_action"},j=h,G=Q,I={BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,PROXY_AUTHENTICATION_REQUIRED:407,REQUEST_TIMEOUT:408,CONFLICT:409,GONE:410,LENGTH_REQUIRED:411,PRECONDITION_FAILED:412,CONTENT_TOO_LARGE:413,URI_TOO_LONG:414,UNSUPPORTED_MEDIA_TYPE:415,RANGE_NOT_SATISFIABLE:416,EXPECTATION_FAILED:417,MISDIRECTED_REQUEST:421,UNPROCESSABLE_CONTENT:422,LOCKED:423,FAILED_DEPENDENCY:424,TOO_EARLY:425,UPGRADE_REQUIRED:426,PRECONDITION_REQUIRED:428,TOO_MANY_REQUESTS:429,REQUEST_HEADER_FIELDS_TOO_LARGE:431,UNAVAILABLE_FOR_LEGAL_REASONS:451,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,HTTP_VERSION_NOT_SUPPORTED:505,VARIANT_ALSO_NEGOTIATES:506,INSUFFICIENT_STORAGE:507,LOOP_DETECTED:508,NETWORK_AUTHENTICATION_REQUIRED:511},V=Object.entries(I).reduce((e,[t,a])=>({...e,[a]:t}),{});class f extends Error{type="AstroActionError";code="INTERNAL_SERVER_ERROR";status=500;constructor(t){super(t.message),this.code=t.code,this.status=f.codeToStatus(t.code),t.stack&&(this.stack=t.stack)}static codeToStatus(t){return I[t]}static statusToCode(t){return V[t]??"INTERNAL_SERVER_ERROR"}static fromJson(t){return $(t)?new J(t.issues):Y(t)?new f(t):new f({code:"INTERNAL_SERVER_ERROR"})}}function Y(e){return typeof e=="object"&&e!=null&&"type"in e&&e.type==="AstroActionError"}function $(e){return typeof e=="object"&&e!=null&&"type"in e&&e.type==="AstroActionInputError"&&"issues"in e&&Array.isArray(e.issues)}class J extends f{type="AstroActionInputError";issues;fields;constructor(t){super({message:`Failed to validate: ${JSON.stringify(t,null,2)}`,code:"BAD_REQUEST"}),this.issues=t,this.fields={};for(const a of t)if(a.path.length>0){const n=a.path[0].toString();this.fields[n]??=[],this.fields[n]?.push(a.message)}}}function _(e){return`?${new URLSearchParams({[h.actionName]:e}).toString()}`}function A(e){if(e.type==="error"){let t;try{t=JSON.parse(e.body)}catch{return{data:void 0,error:new f({message:e.body,code:"INTERNAL_SERVER_ERROR"})}}return{error:f.fromJson(t),data:void 0}}return e.type==="empty"?{data:void 0,error:void 0}:{data:H(e.body,{URL:t=>new URL(t)}),error:void 0}}const q="%2E";function m(e={},t=""){return new Proxy(e,{get(a,n){if(a.hasOwnProperty(n)||typeof n=="symbol")return a[n];const s=t+encodeURIComponent(n.toString()).replaceAll(".",q);function r(l){return d(l,s)}return Object.assign(r,{queryString:_(s),toString:()=>r.queryString,bind:r.bind,valueOf:()=>r.valueOf,$$FORM_ACTION:function(){return{method:"POST",name:"_astroAction",action:"?"+new URLSearchParams(r.toString()).toString()}},async orThrow(l){const{data:o,error:i}=await d(l,s);if(i)throw i;return o}}),m(r,s+".")}})}function W(e){let t=`${"/".replace(/\/$/,"")}/_actions/${new URLSearchParams(e()).get(j.actionName)}`;return t=G(t),t}async function d(e,t,a){const n=new Headers;n.set("Accept","application/json");for(const[o,i]of Object.entries(C))n.set(o,i);let s=e;if(!(s instanceof FormData)){try{s=JSON.stringify(e)}catch(o){throw new f({code:"BAD_REQUEST",message:`Failed to serialize request body to JSON. Full error: ${o.message}`})}s?n.set("Content-Type","application/json"):n.set("Content-Length","0")}const r=await fetch(W(()=>_(t)),{method:"POST",body:s,headers:n});if(r.status===204)return A({type:"empty",status:204});const l=await r.text();return r.ok?A({type:"data",body:l,status:200,contentType:"application/json+devalue"}):A({type:"error",body:l,status:r.status,contentType:"application/json"})}const S=m(),g=document.getElementById("data-container"),p=g?.dataset.likes,O=g?.dataset.hash,Z=p?Number(p):0,D=O||"",z=document.querySelector("span#increaseCount"),N=document.getElementById("like-count");z?.addEventListener("click",async()=>{const{data:e,error:t}=await S.likePost({hash:D});e&&N&&(N.innerHTML=`${Z+1} likes`)});setTimeout(async()=>{const{data:e,error:t}=await S.updatePostVisits({hash:D})},1e3*20);document.addEventListener("DOMContentLoaded",()=>{console.log("DOM content loaded");const e=document.getElementById("sf-reading-progress-bar");if(e){let t=!1;window.addEventListener("scroll",()=>{const a=document.documentElement.scrollTop||document.body.scrollTop,n=document.querySelector("footer")?.clientHeight??0,s=document.documentElement.scrollHeight-(document.documentElement.clientHeight+n),r=a/s*100;e.style.width=`${r}%`,r>=96&&!t&&(t=!0,confetti({particleCount:100,spread:70,origin:{y:.5}}))})}});
